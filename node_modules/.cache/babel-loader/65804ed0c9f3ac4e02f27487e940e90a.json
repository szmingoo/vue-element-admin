{"remainingRequest":"D:\\code\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\code\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\vue-element-admin\\src\\views\\table\\drag-table.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\code\\vue-element-admin\\src\\views\\table\\drag-table.vue","mtime":1670579278588},{"path":"D:\\code\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500371},{"path":"D:\\code\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532801399},{"path":"D:\\code\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500371},{"path":"D:\\code\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L2NvZGUvdnVlLWVsZW1lbnQtYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZldGNoTGlzdCB9IGZyb20gJ0AvYXBpL2FydGljbGUnOwppbXBvcnQgU29ydGFibGUgZnJvbSAnc29ydGFibGVqcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRHJhZ1RhYmxlJywKICBmaWx0ZXJzOiB7CiAgICBzdGF0dXNGaWx0ZXI6IGZ1bmN0aW9uIHN0YXR1c0ZpbHRlcihzdGF0dXMpIHsKICAgICAgdmFyIHN0YXR1c01hcCA9IHsKICAgICAgICBwdWJsaXNoZWQ6ICdzdWNjZXNzJywKICAgICAgICBkcmFmdDogJ2luZm8nLAogICAgICAgIGRlbGV0ZWQ6ICdkYW5nZXInCiAgICAgIH07CiAgICAgIHJldHVybiBzdGF0dXNNYXBbc3RhdHVzXTsKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0OiBudWxsLAogICAgICB0b3RhbDogbnVsbCwKICAgICAgbGlzdExvYWRpbmc6IHRydWUsCiAgICAgIGxpc3RRdWVyeTogewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgbGltaXQ6IDEwCiAgICAgIH0sCiAgICAgIHNvcnRhYmxlOiBudWxsLAogICAgICBvbGRMaXN0OiBbXSwKICAgICAgbmV3TGlzdDogW10KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRMaXN0OiBmdW5jdGlvbiBnZXRMaXN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBfeWllbGQkZmV0Y2hMaXN0LCBkYXRhOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzLmxpc3RMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGZldGNoTGlzdChfdGhpcy5saXN0UXVlcnkpOwogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCRmZXRjaExpc3QgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCRmZXRjaExpc3QuZGF0YTsKICAgICAgICAgICAgICAgIF90aGlzLmxpc3QgPSBkYXRhLml0ZW1zOwogICAgICAgICAgICAgICAgX3RoaXMudG90YWwgPSBkYXRhLnRvdGFsOwogICAgICAgICAgICAgICAgX3RoaXMubGlzdExvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF90aGlzLm9sZExpc3QgPSBfdGhpcy5saXN0Lm1hcChmdW5jdGlvbiAodikgewogICAgICAgICAgICAgICAgICByZXR1cm4gdi5pZDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX3RoaXMubmV3TGlzdCA9IF90aGlzLm9sZExpc3Quc2xpY2UoKTsKICAgICAgICAgICAgICAgIF90aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnNldFNvcnQoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2V0U29ydDogZnVuY3Rpb24gc2V0U29ydCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciBlbCA9IHRoaXMuJHJlZnMuZHJhZ1RhYmxlLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCcuZWwtdGFibGVfX2JvZHktd3JhcHBlciA+IHRhYmxlID4gdGJvZHknKVswXTsKICAgICAgdGhpcy5zb3J0YWJsZSA9IFNvcnRhYmxlLmNyZWF0ZShlbCwgewogICAgICAgIGdob3N0Q2xhc3M6ICdzb3J0YWJsZS1naG9zdCcsCiAgICAgICAgLy8gQ2xhc3MgbmFtZSBmb3IgdGhlIGRyb3AgcGxhY2Vob2xkZXIsCiAgICAgICAgc2V0RGF0YTogZnVuY3Rpb24gc2V0RGF0YShkYXRhVHJhbnNmZXIpIHsKICAgICAgICAgIC8vIHRvIGF2b2lkIEZpcmVmb3ggYnVnCiAgICAgICAgICAvLyBEZXRhaWwgc2VlIDogaHR0cHM6Ly9naXRodWIuY29tL1J1YmFYYS9Tb3J0YWJsZS9pc3N1ZXMvMTAxMgogICAgICAgICAgZGF0YVRyYW5zZmVyLnNldERhdGEoJ1RleHQnLCAnJyk7CiAgICAgICAgfSwKICAgICAgICBvbkVuZDogZnVuY3Rpb24gb25FbmQoZXZ0KSB7CiAgICAgICAgICB2YXIgdGFyZ2V0Um93ID0gX3RoaXMyLmxpc3Quc3BsaWNlKGV2dC5vbGRJbmRleCwgMSlbMF07CiAgICAgICAgICBfdGhpczIubGlzdC5zcGxpY2UoZXZ0Lm5ld0luZGV4LCAwLCB0YXJnZXRSb3cpOwoKICAgICAgICAgIC8vIGZvciBzaG93IHRoZSBjaGFuZ2VzLCB5b3UgY2FuIGRlbGV0ZSBpbiB5b3UgY29kZQogICAgICAgICAgdmFyIHRlbXBJbmRleCA9IF90aGlzMi5uZXdMaXN0LnNwbGljZShldnQub2xkSW5kZXgsIDEpWzBdOwogICAgICAgICAgX3RoaXMyLm5ld0xpc3Quc3BsaWNlKGV2dC5uZXdJbmRleCwgMCwgdGVtcEluZGV4KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["drag-table.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <!-- Note that row-key is necessary to get a correct row order. -->\r\n    <el-table ref=\"dragTable\" v-loading=\"listLoading\" :data=\"list\" row-key=\"id\" border fit highlight-current-row style=\"width: 100%\">\r\n      <el-table-column align=\"center\" label=\"ID\" width=\"65\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.id }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"180px\" align=\"center\" label=\"Date\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.timestamp | parseTime('{y}-{m}-{d} {h}:{i}') }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column min-width=\"300px\" label=\"Title\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.title }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"110px\" align=\"center\" label=\"Author\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.author }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column width=\"100px\" label=\"Importance\">\r\n        <template slot-scope=\"{row}\">\r\n          <svg-icon v-for=\"n in + row.importance\" :key=\"n\" icon-class=\"star\" class=\"icon-star\" />\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column align=\"center\" label=\"Readings\" width=\"95\">\r\n        <template slot-scope=\"{row}\">\r\n          <span>{{ row.pageviews }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column class-name=\"status-col\" label=\"Status\" width=\"110\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-tag :type=\"row.status | statusFilter\">\r\n            {{ row.status }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column align=\"center\" label=\"Drag\" width=\"80\">\r\n        <template slot-scope=\"{}\">\r\n          <svg-icon class=\"drag-handler\" icon-class=\"drag\" />\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <div class=\"show-d\">\r\n      <el-tag>The default order :</el-tag> {{ oldList }}\r\n    </div>\r\n    <div class=\"show-d\">\r\n      <el-tag>The after dragging order :</el-tag> {{ newList }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fetchList } from '@/api/article'\r\nimport Sortable from 'sortablejs'\r\n\r\nexport default {\r\n  name: 'DragTable',\r\n  filters: {\r\n    statusFilter(status) {\r\n      const statusMap = {\r\n        published: 'success',\r\n        draft: 'info',\r\n        deleted: 'danger'\r\n      }\r\n      return statusMap[status]\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      list: null,\r\n      total: null,\r\n      listLoading: true,\r\n      listQuery: {\r\n        page: 1,\r\n        limit: 10\r\n      },\r\n      sortable: null,\r\n      oldList: [],\r\n      newList: []\r\n    }\r\n  },\r\n  created() {\r\n    this.getList()\r\n  },\r\n  methods: {\r\n    async getList() {\r\n      this.listLoading = true\r\n      const { data } = await fetchList(this.listQuery)\r\n      this.list = data.items\r\n      this.total = data.total\r\n      this.listLoading = false\r\n      this.oldList = this.list.map(v => v.id)\r\n      this.newList = this.oldList.slice()\r\n      this.$nextTick(() => {\r\n        this.setSort()\r\n      })\r\n    },\r\n    setSort() {\r\n      const el = this.$refs.dragTable.$el.querySelectorAll('.el-table__body-wrapper > table > tbody')[0]\r\n      this.sortable = Sortable.create(el, {\r\n        ghostClass: 'sortable-ghost', // Class name for the drop placeholder,\r\n        setData: function(dataTransfer) {\r\n          // to avoid Firefox bug\r\n          // Detail see : https://github.com/RubaXa/Sortable/issues/1012\r\n          dataTransfer.setData('Text', '')\r\n        },\r\n        onEnd: evt => {\r\n          const targetRow = this.list.splice(evt.oldIndex, 1)[0]\r\n          this.list.splice(evt.newIndex, 0, targetRow)\r\n\r\n          // for show the changes, you can delete in you code\r\n          const tempIndex = this.newList.splice(evt.oldIndex, 1)[0]\r\n          this.newList.splice(evt.newIndex, 0, tempIndex)\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.sortable-ghost{\r\n  opacity: .8;\r\n  color: #fff!important;\r\n  background: #42b983!important;\r\n}\r\n</style>\r\n\r\n<style scoped>\r\n.icon-star{\r\n  margin-right:2px;\r\n}\r\n.drag-handler{\r\n  width: 20px;\r\n  height: 20px;\r\n  cursor: pointer;\r\n}\r\n.show-d{\r\n  margin-top: 15px;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/table"}]}